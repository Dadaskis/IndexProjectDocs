<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>
			Index Project - non_playable_character
		</title>
		<link rel="preload" as="image" href="../../../assets/images/docs_background.png">
		<link rel="stylesheet" type="text/css" href="../../../assets/style.css">
	</head>
	<body>
		<div class="scanlines">
		</div>
		<script src="../../../assets/sidebar_injector_module.js">
		</script>
		<center>
			<div class="everything">
				<div class="sidebar">
					<h1>
						Index Project Guide
					</h1>
					<br/>
					<br/>
					<input type="text" class="searchbar" placeholder="Search...">
						<div class="sidebar-content" id="sidebar-content">
						</div>
					</div>
					<div class="main_body">
						<h3>
							Module: non_playable_character
						</h3>
						<p class="red-marking">
							Documentation last edited: October 23, 2025 at 14:33 UTC
						</p>
						<div class="lang-select-div">
							<a href="./index.html">
								ENG
							</a>
							<a href="./index_rus.html">
								RUS
							</a>
						</div>
						<h4>
							Description
						</h4>
						<p>
							So let's talk about this horrible piece of shit module. Yes, those are Non-Playable Characters (NPCs). Seems to be alright. However, even though this module was initially designed as a universal platform for all kinds of NPCs, not only human characters, it ended up being a module solely for human characters! You wouldn't be working with <code class="gdscript">
								NonPlayableCharacter
							</code>
							that much, you'll be working with <code class="gdscript">
								NPCHuman
							</code>
							all the time. It would've been nicer to call this module <code class="gdscript">
								"human_characters"
							</code>
							or <code class="gdscript">
								"human_NPC"
							</code>
							or <code class="gdscript">
								"NPC_human"
							</code>
							. Either way, does it matter? You can just realize that this module is all about humans.<br>
							<br>
						</p>
						<h4 style="width: 60%">
							Script Structure
						</h4>
						<p>
						</p>
						<center>
							<code class="gdscript">
								<br>
								.<br>
								├── autoload<br>
								│   ├── NPC_attack_queue.gd<br>
								│   ├── NPC_max_distance_manager.gd<br>
								│   ├── NPC_names.gd<br>
								│   ├── NPC_position_queue.gd<br>
								│   ├── NPC_spawn_queue.gd<br>
								│   └── NPC_vision_queue.gd<br>
								├── base_script.gd<br>
								├── base_scripts<br>
								│   ├── assets<br>
								│   │   └── sounds<br>
								│   │       ├── beeping.mp3<br>
								│   │       ├── beeping.mp3.import<br>
								│   │       ├── electrowave_attack.mp3<br>
								│   │       ├── electrowave_attack.mp3.import<br>
								│   │       ├── electrowave_imbound.mp3<br>
								│   │       └── electrowave_imbound.mp3.import<br>
								│   ├── minc_chemical_unit.gd<br>
								│   ├── minc_electro_unit.gd<br>
								│   ├── minc_explosives_unit.gd<br>
								│   └── minc_heavy_unit_weak.gd<br>
								├── configs<br>
								│   ├── character_data.gd<br>
								│   ├── hitbox_damage_multiplier.gd<br>
								│   ├── hitbox_data.gd<br>
								│   └── weapon_config.gd<br>
								├── debug<br>
								│   └── logic_state_label.gd<br>
								├── logic.gd<br>
								├── nodes<br>
								│   ├── dead_body_search.gd<br>
								│   ├── dropped_weapon.gd<br>
								│   ├── NPC_spawn.gd<br>
								│   └── patrol_point_hint.gd<br>
								├── non_playable_character.gd<br>
								├── pathfinding.gd<br>
								├── state_base.gd<br>
								├── states<br>
								│   ├── citizen<br>
								│   │   ├── act_playing.gd<br>
								│   │   ├── attack_player.gd<br>
								│   │   ├── none.gd<br>
								│   │   ├── panic_anim.gd<br>
								│   │   ├── panic.gd<br>
								│   │   └── patrol.gd<br>
								│   ├── heavy_unit<br>
								│   │   ├── attack.gd<br>
								│   │   ├── attack_player.gd<br>
								│   │   ├── follow_player.gd<br>
								│   │   ├── none.gd<br>
								│   │   ├── patrol.gd<br>
								│   │   ├── stand_and_shoot.gd<br>
								│   │   ├── stand_and_shoot_player.gd<br>
								│   │   ├── test_look.gd<br>
								│   │   └── wait_enemy.gd<br>
								│   └── light_unit<br>
								│       ├── attack.gd<br>
								│       ├── attack_player.gd<br>
								│       ├── follow_player.gd<br>
								│       ├── none.gd<br>
								│       ├── patrol.gd<br>
								│       ├── stand_and_shoot.gd<br>
								│       ├── stand_and_shoot_player.gd<br>
								│       ├── test_look.gd<br>
								│       └── wait_enemy.gd<br>
								└── types<br>
								├── human<br>
								│   ├── base_script_human.gd<br>
								│   ├── human_weapon_handler.gd<br>
								│   └── state_base_human.gd<br>
								└── human.gd<br>
							</code>
						</center>
						<p>
							<br>
							<br>
						</p>
						<h2>
							Core scripts <code class="gdscript">
								"./"
							</code>
						</h2>
						<p>
							<br>
							<code class="gdscript">
								"non_playable_character.gd"
							</code>
							is a <code class="gdscript">
								NonPlayableCharacter
							</code>
							base class for all NPCs. NPCs in question are humans, of course. It contains all the basic functionality needed to make an NPC, which is extended by <code class="gdscript">
								NPCHuman
							</code>
							.<br>
							<code class="gdscript">
								"state_base.gd"
							</code>
							is a <code class="gdscript">
								NPCLogicState
							</code>
							base class for logic states of NPCs. Each logic state contains unique logic to execute in Finite-State Machine of this NPC.<br>
							<code class="gdscript">
								"pathfinding.gd"
							</code>
							is a <code class="gdscript">
								NPCPathfinding
							</code>
							pathfinding class, it is using navigation mesh to navigate the NPC in locations.<br>
							<code class="gdscript">
								"base_script.gd"
							</code>
							is a <code class="gdscript">
								NPCBaseScript
							</code>
							NPC base script class that can be used for "base scripts" which can extend logic of certain NPCs. Usually used by <code class="gdscript">
								"heavy units"
							</code>
							to make the "fall down on the floor after too much damage" logic.<br>
							<code class="gdscript">
								"logic.gd"
							</code>
							is a <code class="gdscript">
								NPCLogic
							</code>
							class that is handling the logic states and visibility detection of other characters. This class is practically being a Finite-State Machine.<br>
							<br>
						</p>
						<h2>
							Autoloads <code class="gdscript">
								"./autoloads/"
							</code>
						</h2>
						<p>
							<br>
							<code class="gdscript">
								NPCAttackQueue
							</code>
							- a queue to optimize NPC attacks to prevent too many attacks in the same frame.<br>
							<code class="gdscript">
								NPCMaxDistanceManager
							</code>
							- a manager of NPCs that were temporarily removed from the scene tree (due to distance) for optimization.<br>
							<code class="gdscript">
								NPCNames
							</code>
							- a singleton that generates names for NPCs.<br>
							<code class="gdscript">
								NPCPositionQueue
							</code>
							- <code class="red-marking">
								Obsolete
							</code>
							Incomplete implementation for the cover system of NPCs.<br>
							<code class="gdscript">
								NPCSpawnQueue
							</code>
							- a queue to make an order of NPC spawns so they would be spawning one-by-one for correct support of properties like <code class="gdscript">
								named_npc_alive_limit
							</code>
							of <code class="gdscript">
								NPCSpawn
							</code>
							.<br>
							<code class="gdscript">
								NPCVisionQueue
							</code>
							- a queue to optimize visibility checks of NPCs, only one NPC per frame does a visibility check to prevent too many checks done in one frame.<br>
							<br>
						</p>
						<h2>
							Configs <code class="gdscript">
								"./configs"
							</code>
						</h2>
						<p>
							<br>
							<code class="gdscript">
								NPCHitboxData
							</code>
							- a config that contains an array of <code class="gdscript">
								NPCHitboxDamageMultiplier
							</code>
							which define damage multipliers of each hitbox bone (aka head can get 2x more damage than other bones and etc).<br>
							<code class="gdscript">
								NPCWeaponConfig
							</code>
							- a config for an NPC weapon, for the time being only supported for firearms.<br>
							<code class="gdscript">
								NPCHitboxDamageMultiplier
							</code>
							- a config that contains a bone name and a multiplier by which the damage will be multiplied.<br>
							<code class="gdscript">
								NPCCharacterData
							</code>
							- a character data config that contains a variety of settings like faction name, health/armor, human model name, assigned weapons, experience for a kill, etc.<br>
							<br>
						</p>
						<h2>
							Nodes "
						</code>
						./nodes"
					</code>
				</h2>
				<p>
					<br>
					<code class="gdscript">
						"dead_body_search.gd"
					</code>
					- a code that can be runned when you have <code class="gdscript">
						"Ammo Pickup"
					</code>
					perk (<code class="gdscript">
						"loot_corpses"
					</code>
					perk boolean), it is allowing the player to loot ammo from dead bodies by interacting with them.<br>
					<code class="gdscript">
						"dropped_weapon.gd"
					</code>
					- a dropped weapon code, weapons of NPCs are <code class="gdscript">
						HumanModel
					</code>
					weapons that were duplicated and turned into rigidbodies. This code allows to add logic to those rigidbodies to make it possible to pickup the weapon. Keep in mind, this is separate from player dropped weapons or dropped weapons that were pre-placed on any location.<br>
					<code class="gdscript">
						"NPC_spawn.gd"
					</code>
					- a <code class="gdscript">
						NPCSpawn
					</code>
					node that gives you a possibility to spawn an NPC, provides a huge amount of settings to configure. It is initializing an NPC once and then reuses its instance. You can only spawn one simultaneously alive NPC with this node.<br>
					<code class="gdscript">
						"patrol_point_hint.gd"
					</code>
					- a patrol point hint node that allows the user to set an NPC's patrol position that can be randomly chosen in a patrol state.<br>
					<br>
				</p>
				<h2>
					Base Scripts <code class="gdscript">
						"./base_scripts"
					</code>
				</h2>
				<p>
					<br>
					Base scripts are extending the functionality of NPCs by making it possible to run additional logic on top of the NPC's code without overriding the existing code. All base scripts are stored at <code class="gdscript">
						"res://modules/non_playable_character/src/base_scripts/"
					</code>
					. You can assign a base logic script in <code class="gdscript">
						NPCCharacterData
					</code>
					.<br>
					<code>
						Template
					</code>
					<br>
					<code class="gdscript">
						<br>
						extends NPCBaseScript<br>
						<br>
						# Initialization, can be overriden<br>
						func initialize():<br>
						&emsp;pass<br>
						<br>
						# Update, called each physics frame<br>
						func update(delta: float):<br>
						&emsp;pass<br>
					</code>
					<br>
					<br>
				</p>
				<h2>
					Logic States <code class="gdscript">
						"./states"
					</code>
				</h2>
				<p>
					<br>
					Each folder in <code class="gdscript">
						"res://modules/non_playable_character/src/states/"
					</code>
					creates a logic set that can be defined in <code class="gdscript">
						NPCCharacterData
					</code>
					. And each logic set is a set of logic states that define the NPC's behavior. NPC's logic works by the principle of Finite-State Machine.<br>
					<code>
						Template
					</code>
					<br>
					<code class="gdscript">
						<br>
						class_name _LogicSet_NameHere<br>
						# ^^^<br>
						# It is important to have a class name defined for a logic state due to additional performance.<br>
						# It isn't necessary for functionality, but, for some reason, a class name optimizes the work<br>
						# of logic states.<br>
						<br>
						extends NPCLogicStateHuman<br>
						<br>
						# Runs when NPCLogic switches on this state<br>
						func on_switch() ->
						void:<br>
						&emsp;pass<br>
						<br>
						# An update that happens during _physics-process<br>
						func update(delta: float) ->
						void:<br>
						&emsp;pass<br>
					</code>
					<br>
					<br>
				</p>
				<h2>
					Types <code class="gdscript">
						"./types"
					</code>
				</h2>
				<p>
					<br>
					Remember I said it was supposed to be a universal platform for NPCs? So yeah, <code class="gdscript">
						NPCHuman
					</code>
					have captured this entire module and now <code class="gdscript">
						"human.gd"
					</code>
					is the heart of this module. It is defining the human NPCs, that are being the only working type here. It may be possible to make different types still, but it would require quite a rewrite. Deep in that NPC system, there's still a support for types so yeah there's that folder too.<br>
					<br>
				</p>
				<h4 style="width: 60%">
					Creation of NPCs
				</h4>
				<p>
					<br>
					<img src="../../../assets/images/non_playable_character/adding0.png" width="400px" onclick="maximizeImage(this)" class="clickable-image">
						<br>
						<img src="../../../assets/images/non_playable_character/adding1.png" width="400px" onclick="maximizeImage(this)" class="clickable-image">
							<br>
							0. Create a new folder for your character at <code class="gdscript">
								"res://modules/non_playable_character/assets/characters/"
							</code>
							, your new folder's name is going to be a name for NPC character class.<br>
							1. Create <code class="gdscript">
								"config.tres"
							</code>
							as <code class="gdscript">
								NPCCharacterData
							</code>
							<br>
							2. Define the settings<br>
							<code class="red-marking">
								If you want to make a new model for NPC instead of using an existing one, please, take a look at <code class="gdscript">
									"human_model"
								</code>
								or <code class="gdscript">
									"character_builder"
								</code>
								module docs.
							</code>
						</p>
						<h3>
							General Information
						</h3>
						<h4>
							Root directories list
						</h4>
						<p>
							assets, docs, src
						</p>
						<h4>
							Nodes
						</h4>
						<p>
							<a class="a_simple" href="./scripts/NPC_attack_queue.html">
								NPCAttackQueue
							</a>
							<br>
							<a class="a_simple" href="./scripts/NPC_max_distance_manager.html">
								NPCMaxDistanceManager
							</a>
							<br>
							<a class="a_simple" href="./scripts/NPC_names.html">
								NPCNames
							</a>
							<br>
							<a class="a_simple" href="./scripts/NPC_position_queue.html">
								NPCPositionQueue
							</a>
							<br>
							<a class="a_simple" href="./scripts/NPC_spawn_queue.html">
								NPCSpawnQueue
							</a>
							<br>
							<a class="a_simple" href="./scripts/NPC_vision_queue.html">
								NPCVisionQueue
							</a>
							<br>
							<a class="a_simple" href="./scripts/logic_state_label.html">
								logic_state_label
							</a>
							<br>
							<a class="a_simple" href="./scripts/dropped_weapon.html">
								dropped_weapon
							</a>
							<br>
							<a class="a_simple" href="./scripts/NPC_spawn.html">
								NPCSpawn
							</a>
							<br>
							<a class="a_simple" href="./scripts/patrol_point_hint.html">
								NPCPatrolPointHint
							</a>
							<br>
							<a class="a_simple" href="./scripts/non_playable_character.html">
								NonPlayableCharacter
							</a>
						</p>
						<h4>
							Classes
						</h4>
						<p>
							<a class="a_simple" href="./scripts/base_script.html">
								NPCBaseScript
							</a>
							<br>
							<a class="a_simple" href="./scripts/minc_chemical_unit.html">
								minc_chemical_unit
							</a>
							<br>
							<a class="a_simple" href="./scripts/minc_electro_unit.html">
								minc_electro_unit
							</a>
							<br>
							<a class="a_simple" href="./scripts/minc_explosives_unit.html">
								minc_explosives_unit
							</a>
							<br>
							<a class="a_simple" href="./scripts/minc_heavy_unit_weak.html">
								minc_heavy_unit_weak
							</a>
							<br>
							<a class="a_simple" href="./scripts/logic.html">
								NPCLogic
							</a>
							<br>
							<a class="a_simple" href="./scripts/dead_body_search.html">
								dead_body_search
							</a>
							<br>
							<a class="a_simple" href="./scripts/pathfinding.html">
								NPCPathfinding
							</a>
							<br>
							<a class="a_simple" href="./scripts/act_playing.html">
								_Citizen_ActPlaying
							</a>
							<br>
							<a class="a_simple" href="./scripts/attack_player.html">
								_Citizen_AttackPlayer
							</a>
							<br>
							<a class="a_simple" href="./scripts/none.html">
								_Citizen_None
							</a>
							<br>
							<a class="a_simple" href="./scripts/panic.html">
								_Citizen_Panic
							</a>
							<br>
							<a class="a_simple" href="./scripts/panic_anim.html">
								_Citizen_PanicAnim
							</a>
							<br>
							<a class="a_simple" href="./scripts/patrol.html">
								_Citizen_Patrol
							</a>
							<br>
							<a class="a_simple" href="./scripts/attack.html">
								_HeavyUnit_Attack
							</a>
							<br>
							<a class="a_simple" href="./scripts/attack_player.html">
								_HeavyUnit_AttackPlayer
							</a>
							<br>
							<a class="a_simple" href="./scripts/follow_player.html">
								_HeavyUnit_FollowAttack
							</a>
							<br>
							<a class="a_simple" href="./scripts/none.html">
								_HeavyUnit_None
							</a>
							<br>
							<a class="a_simple" href="./scripts/patrol.html">
								_HeavyUnit_Patrol
							</a>
							<br>
							<a class="a_simple" href="./scripts/stand_and_shoot.html">
								_HeavyUnit_StandAndShoot
							</a>
							<br>
							<a class="a_simple" href="./scripts/stand_and_shoot_player.html">
								_HeavyUnit_StandAndShootPlayer
							</a>
							<br>
							<a class="a_simple" href="./scripts/test_look.html">
								_HeavyUnit_TestLook
							</a>
							<br>
							<a class="a_simple" href="./scripts/wait_enemy.html">
								_HeavyUnit_WaitEnemy
							</a>
							<br>
							<a class="a_simple" href="./scripts/attack.html">
								_LightUnit_Attack
							</a>
							<br>
							<a class="a_simple" href="./scripts/attack_player.html">
								_LightUnit_AttackPlayer
							</a>
							<br>
							<a class="a_simple" href="./scripts/follow_player.html">
								_LightUnit_FollowAttack
							</a>
							<br>
							<a class="a_simple" href="./scripts/none.html">
								_LightUnit_None
							</a>
							<br>
							<a class="a_simple" href="./scripts/patrol.html">
								_LightUnit_Patrol
							</a>
							<br>
							<a class="a_simple" href="./scripts/stand_and_shoot.html">
								_LightUnit_StandAndShoot
							</a>
							<br>
							<a class="a_simple" href="./scripts/stand_and_shoot_player.html">
								_LightUnit_StandAndShootPlayer
							</a>
							<br>
							<a class="a_simple" href="./scripts/test_look.html">
								_LightUnit_TestLook
							</a>
							<br>
							<a class="a_simple" href="./scripts/wait_enemy.html">
								_LightUnit_WaitEnemy
							</a>
							<br>
							<a class="a_simple" href="./scripts/state_base.html">
								NPCLogicState
							</a>
							<br>
							<a class="a_simple" href="./scripts/base_script_human.html">
								NPCBaseScriptHuman
							</a>
							<br>
							<a class="a_simple" href="./scripts/human_weapon_handler.html">
								NPCHumanWeaponHandler
							</a>
							<br>
							<a class="a_simple" href="./scripts/state_base_human.html">
								NPCLogicStateHuman
							</a>
							<br>
							<a class="a_simple" href="./scripts/human.html">
								NPCHuman
							</a>
						</p>
						<h4>
							Resources
						</h4>
						<p>
							<a class="a_simple" href="./scripts/character_data.html">
								NPCCharacterData
							</a>
							<br>
							<a class="a_simple" href="./scripts/hitbox_damage_multiplier.html">
								NPCHitboxDamageMultiplier
							</a>
							<br>
							<a class="a_simple" href="./scripts/hitbox_data.html">
								NPCHitboxData
							</a>
							<br>
							<a class="a_simple" href="./scripts/weapon_config.html">
								NPCWeaponConfig
							</a>
						</p>
						<h4>
							Other Scripts
						</h4>
						<p>
							None
						</p>
					</div>
				</div>
			</center>
			<script src="../../../assets/code_blocks.js">
			</script>
		</body>
	</html>
